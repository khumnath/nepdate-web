import{r as t,j as a,$ as ce,D as q,X as ue,M as he,e as me,f as fe,_ as pe}from"./vendor-react-DR7v2TWw.js";import{a1 as ge,a2 as we,t as Q,a3 as ye,_ as K,K as be,a4 as xe,d as Se,a5 as ke,a6 as ve,N as L,a7 as Z,a8 as ee,a9 as Ae,aa as je,$ as Te,b as H,ab as Ie,ac as Ee,ad as Ce,ae as Me,af as Ne,ag as De,ah as Le}from"./bikram-D51OUXLN.js";import{D as Re,A as Pe}from"./pages-CjPYCjpF.js";import"./index-DOm_ocpx.js";import{l as Be,m as Ye,a as $e,b as Ve}from"./vendor-leaflet-Ch3uxlbW.js";const We=()=>{const[e,n]=t.useState("light");return t.useEffect(()=>{const f=localStorage.getItem("theme")||"light";n(f),document.documentElement.classList.toggle("dark",f==="dark")},[]),{theme:e,toggleTheme:()=>{const l=e==="light"?"dark":"light";n(l),localStorage.setItem("theme",l),document.documentElement.classList.toggle("dark",l==="dark")},resetTheme:()=>{localStorage.removeItem("theme"),n("light"),document.documentElement.classList.toggle("dark",!1)}}},_e=()=>{const[e,n]=t.useState("tabs"),[S,h]=t.useState("topbar");return t.useEffect(()=>{const o=localStorage.getItem("menuStyle");n(o||"tabs");const d=localStorage.getItem("desktopLayoutStyle");h(d||"topbar")},[]),{menuStyle:e,desktopLayoutStyle:S,handleSetMenuStyle:o=>{n(o),localStorage.setItem("menuStyle",o)},handleSetDesktopLayoutStyle:o=>{h(o),localStorage.setItem("desktopLayoutStyle",o)},resetLayoutSettings:()=>{localStorage.removeItem("menuStyle"),localStorage.removeItem("desktopLayoutStyle"),n("tabs"),h("topbar")}}};function te(e={}){const{immediate:n=!1,onNeedRefresh:S,onOfflineReady:h,onRegistered:l,onRegisteredSW:f,onRegisterError:c}=e;let o,d;const p=async(s=!0)=>{await d};async function g(){if("serviceWorker"in navigator){if(o=await ge(async()=>{const{Workbox:s}=await import("./vendor-other-DQJqTIja.js").then(i=>i.w);return{Workbox:s}},[],import.meta.url).then(({Workbox:s})=>new s("./sw.js",{scope:"./",type:"classic"})).catch(s=>{c?.(s)}),!o)return;o.addEventListener("activated",s=>{(s.isUpdate||s.isExternal)&&window.location.reload()}),o.addEventListener("installed",s=>{s.isUpdate||h?.()}),o.register({immediate:n}).then(s=>{f?f("./sw.js",s):l?.(s)}).catch(s=>{c?.(s)})}}return d=g(),p}const Oe=()=>{const[e,n]=t.useState(!1),[S,h]=t.useState(!1),[l,f]=t.useState(()=>localStorage.getItem("pwa_installed")==="true"),[c,o]=t.useState(null);return t.useEffect(()=>{te({immediate:!0})},[]),t.useEffect(()=>{const p=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone;if(n(!!p),p){f(!0);return}const g=()=>{localStorage.setItem("pwa_installed","true"),f(!0),h(!1)};window.addEventListener("appinstalled",g),"getInstalledRelatedApps"in navigator&&navigator.getInstalledRelatedApps().then(i=>{i.length>0&&(localStorage.getItem("pwa_installed")!=="true"&&localStorage.setItem("pwa_installed","true"),f(!0))});const s=i=>{i.preventDefault(),localStorage.removeItem("pwa_installed"),f(!1),o(i),h(!0)};return window.addEventListener("beforeinstallprompt",s),()=>{window.removeEventListener("appinstalled",g),window.removeEventListener("beforeinstallprompt",s)}},[]),{isStandalone:e,canInstall:S,isInstalled:l,deferredPrompt:c,handleInstallClick:async()=>{c&&(c.prompt(),await c.userChoice,o(null),h(!1))}}},Ue=()=>{const[e]=t.useState(we()),[n]=t.useState(()=>Q(e)),[S,h]=t.useState(null);t.useEffect(()=>{try{const x=ye(e,27.7172,85.324,5.75);"error"in x?K(`Error from calculate:'${x.error}`,"error",2e3):h(x)}catch(x){K(`Error calculating today details:${x}`,"error",2e3)}},[]);const[l,f]=t.useState("bs"),[c,o]=t.useState(n.year),[d,p]=t.useState(n.monthIndex),[g,s]=t.useState(e.getFullYear()),[i,k]=t.useState(e.getMonth()),R=t.useMemo(()=>l==="bs"?c:g,[l,c,g]),y=t.useMemo(()=>l==="bs"?d:i,[l,d,i]),v=t.useCallback(()=>{o(n.year),p(n.monthIndex),s(e.getFullYear()),k(e.getMonth())},[e,n]),A=t.useCallback(b=>{if(b===l)return;const u=g===e.getFullYear()&&i===e.getMonth(),j=c===n.year&&d===n.monthIndex;if(b==="bs"&&u||b==="ad"&&j)v();else if(b==="bs"){const x=g??e.getFullYear(),Y=be(x,i,12),T=xe(Y),M=Q(T);M.year===0||!M.year?v():(o(M.year),p(M.monthIndex))}else if(c===null)v();else{const x=Se(c,d,18);s(x.getUTCFullYear()),k(x.getUTCMonth())}f(b)},[l,g,i,c,d,e,n,v]),P=t.useCallback(b=>{if(l==="bs"){const u=b==="prev"?d-1:d+1;u<0?(p(11),o(j=>(j??n.year)-1)):u>11?(p(0),o(j=>(j??n.year)+1)):p(u)}else{const u=b==="prev"?i-1:i+1;u<0?(k(11),s(j=>(j??e.getFullYear())-1)):u>11?(k(0),s(j=>(j??e.getFullYear())+1)):k(u)}},[l,d,i,e,n]),C=t.useCallback(b=>{l==="bs"?o(u=>(u??n.year)+(b==="next"?1:-1)):s(u=>(u??e.getFullYear())+(b==="next"?1:-1))},[l,e,n]);return{activeSystem:l,currentBsYear:c,currentBsMonth:d,currentAdYear:g,currentAdMonth:i,currentYear:R,currentMonth:y,switchSystem:A,goToToday:v,changeMonth:P,changeYear:C,setCurrentBsYear:o,setCurrentBsMonth:p,setCurrentAdYear:s,setCurrentAdMonth:k,initialToday:e,initialTodayBs:n,todayDetails:S}},Fe=()=>{const[e,n]=t.useState(()=>{if(typeof window>"u")return"calendar";const r=window.location.pathname;if(r.includes("/bs")||r.includes("/ad"))return"day-detail";const w=window.location.hash.replace("#","");if(!w){const I=new URLSearchParams(window.location.search).get("activeView");return I||"calendar"}return w.startsWith("bs?")||w.startsWith("ad?")?"day-detail":w.split("/")[0]||"calendar"}),S=t.useRef("calendar"),[h,l]=t.useState(null),[f,c]=t.useState(!1),[o,d]=t.useState(!1),[p,g]=t.useState(!1),[s,i]=t.useState(!1),[k,R]=t.useState(!1),y=t.useRef(null),v=t.useRef(null),[A,P]=t.useState(!1),C=t.useRef(null),b=t.useRef(0),[u,j]=t.useState(!1);t.useEffect(()=>{let r=null,w=0;const $=25,N=()=>{w++,typeof window.Android<"u"&&typeof window.Android.isAndroidApp=="function"?(j(!0),r&&clearInterval(r)):w>=$&&r&&clearInterval(r)};return N(),u||(r=window.setInterval(N,2e3)),()=>{r&&clearInterval(r)}},[]),t.useEffect(()=>{if(u)return;let r="";if(e!=="calendar"){if(e==="day-detail")return;r=e,e==="kundali"&&s?r+="/result":e==="dharma"&&k&&(r+="/section")}const w=window.location.hash.replace("#",""),N=(window.location.pathname.includes("/bs")||window.location.pathname.includes("/ad"))&&e!=="day-detail";if(w!==r||N){let I=r?`#${r}`:window.location.pathname;N?I=`/${r?"#"+r:""}`:e==="calendar"&&(I=window.location.pathname);const W=S.current!==e,F=S.current!=="calendar"&&e!=="calendar",_=w===""||r.startsWith(w)&&r!==w;W&&F?window.history.replaceState({view:e},"",I):!W&&!_?window.history.replaceState({view:e},"",I):window.history.pushState({view:e},"",I)}S.current=e},[e,s,k,u]),t.useEffect(()=>{const r=w=>{o&&w.key==="Backspace"&&(w.preventDefault(),d(!1))};return o&&window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[o]);const x=t.useCallback(()=>f?(c(!1),!0):p?(g(!1),!0):o?(d(!1),!0):e==="kundali"&&s&&y.current?(y.current(),!0):e==="dharma"&&k&&v.current?(v.current(),!0):u&&e!=="calendar"?(n("calendar"),!0):!1,[f,p,o,e,s,k,u]),B=t.useRef(x);t.useEffect(()=>{B.current=x},[x]),t.useEffect(()=>{const r=()=>{b.current=0,P(!1),C.current&&(clearTimeout(C.current),C.current=null)};if(u)return window.handleBackPress=()=>B.current()?(r(),!0):(b.current+=1,b.current===1?(P(!0),navigator.vibrate&&navigator.vibrate(50),C.current=window.setTimeout(r,2e3),!0):(typeof window.Android?.exitApp=="function"&&window.Android.exitApp(),!1)),()=>{r()};{const w=()=>{if(B.current()){if(window.location.hash.replace("#","")===e)return;if(window.location.hash.replace("#","")!==(e==="calendar"?"":e)){const z=e==="calendar"?window.location.pathname:`#${e}`;setTimeout(()=>{window.history.replaceState({view:e},"",z)},10)}return}const I=window.location.hash.replace("#","").split("/")[0];n(I===""?"calendar":I)};return window.addEventListener("popstate",w),()=>window.removeEventListener("popstate",w)}},[u,e]);const Y=r=>{l(r),c(!0)},T=t.useCallback(r=>{y.current=r},[]),M=t.useCallback(r=>{v.current=r},[]);return{activeView:e,setActiveView:n,selectedDate:h,isModalOpen:f,setIsModalOpen:c,isMenuOpen:o,setIsMenuOpen:d,isAboutOpen:p,setIsAboutOpen:g,isKundaliResultsVisible:s,setIsKundaliResultsVisible:i,setKundaliBackAction:T,isDharmaResultsVisible:k,setIsDharmaResultsVisible:R,setDharmaBackAction:M,showExitToast:A,handleDayClick:Y,isAndroidWebView:u}},He=(e,n)=>{const[S,h]=t.useState(!1),[l,f]=t.useState(null),[c,o]=t.useState(null),[d,p]=t.useState(!1),[g,s]=t.useState(null);return t.useEffect(()=>{typeof window.Android<"u"&&typeof window.Android.openWidgetSettings=="function"&&h(!0)},[]),t.useEffect(()=>{const y=v=>{if(v?.preventDefault?.(),e){n(!1);return}if(d)window.Android?.exitApp?window.Android.exitApp():window.history.length>1?window.history.back():window.close();else{p(!0);const A=window.setTimeout(()=>p(!1),2e3);s(A)}};return window.addEventListener("popstate",y),document.addEventListener("backbutton",y),()=>{window.removeEventListener("popstate",y),document.removeEventListener("backbutton",y),g&&clearTimeout(g)}},[e,d,g,n]),{isAndroidApp:S,showExitToast:d,handleTouchStart:y=>{f(y.touches[0].clientX),o(null)},handleTouchMove:y=>o(y.touches[0].clientX),handleTouchEnd:()=>{if(!l||!c)return;const y=c-l;y>60&&l<50?n(!0):y<-60&&e&&n(!1),f(null),o(null)}}},Ke=()=>{const{theme:e,toggleTheme:n,resetTheme:S}=We(),{menuStyle:h,desktopLayoutStyle:l,handleSetMenuStyle:f,handleSetDesktopLayoutStyle:c,resetLayoutSettings:o}=_e(),{isStandalone:d,canInstall:p,handleInstallClick:g}=Oe(),{activeView:s,setActiveView:i,selectedDate:k,isModalOpen:R,setIsModalOpen:y,isMenuOpen:v,setIsMenuOpen:A,isAboutOpen:P,setIsAboutOpen:C,handleDayClick:b,setIsKundaliResultsVisible:u,setKundaliBackAction:j,setIsDharmaResultsVisible:x,setDharmaBackAction:B,showExitToast:Y}=Fe(),{activeSystem:T,currentYear:M,currentMonth:r,currentBsYear:w,currentBsMonth:$,currentAdYear:N,currentAdMonth:I,switchSystem:W,goToToday:F,changeMonth:_,changeYear:X,setCurrentBsYear:J,setCurrentAdYear:z,setCurrentBsMonth:ae,setCurrentAdMonth:se,initialToday:G,initialTodayBs:E,todayDetails:D}=Ue(),{isAndroidApp:ne,handleTouchStart:re,handleTouchMove:oe,handleTouchEnd:le}=He(v,A),ie=()=>{S(),o(),K.info("Settings reset to default",2e3)};t.useEffect(()=>{const V=new URLSearchParams(window.location.search).get("activeView");V?(i(V),window.history.replaceState({},"","/")):(window.location.hash&&(window.location.hash.startsWith("#bs?")||window.location.hash.startsWith("#ad?"))||window.location.pathname.endsWith("/bs")||window.location.pathname.endsWith("/bs.html")||window.location.pathname.endsWith("/ad")||window.location.pathname.endsWith("/ad.html"))&&i("day-detail")},[i]),t.useEffect(()=>{Y&&K.info("Press back again to exit",2e3)},[Y]);const de=()=>b(G);return a.jsxs("div",{className:`min-h-screen flex flex-col bg-slate-100 dark:bg-gray-800 text-gray-900 dark:text-gray-100 transition-colors relative ${l==="sidebar"?"md:flex-row":""} ${e==="dark"?"dark":""}`,onTouchStart:re,onTouchMove:oe,onTouchEnd:le,children:[l==="topbar"&&a.jsx("div",{className:"w-full z-30 print:hidden hidden md:block border-b border-gray-200 dark:border-gray-700",children:a.jsx(ke,{activeView:s,activeSystem:T,onNavigate:m=>{m==="about"?C(!0):i(m)},showInstall:!d&&p,onInstallClick:g})}),a.jsx("header",{className:"px-4 py-2 dark:border-gray-700 bg-slate-200 dark:bg-gray-800 z-30 md:hidden",children:a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[h==="slide"&&a.jsx("button",{onClick:()=>A(!0),className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",children:a.jsx(ce,{className:"w-5 h-5"})}),a.jsx(ve,{activeSystem:T})]}),h==="tabs"&&!d&&p&&a.jsxs("button",{onClick:g,className:"px-3 py-2 text-left text-xs rounded bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(q,{className:"w-5 h-5"})," ",a.jsx("span",{children:L.installApp})]})]})}),v&&a.jsx("div",{className:"fixed inset-0 bg-black/40 z-40 md:hidden",onClick:()=>A(!1)}),a.jsx("aside",{className:`fixed top-0 left-0 z-50 h-full bg-slate-200 dark:bg-gray-800 shadow-xl transform transition-transform duration-300 ease-in-out
          ${v?"translate-x-0":"-translate-x-full"}
          ${l==="sidebar"?"md:translate-x-0 md:sticky md:h-screen md:w-56":"md:hidden w-64"}`,children:a.jsxs("div",{className:"flex flex-col h-full p-4 overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:"Menu"}),a.jsx("button",{onClick:()=>A(!1),className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 md:hidden",children:a.jsx(ue,{className:"w-5 h-5"})})]}),a.jsxs("nav",{className:"flex flex-col space-y-3 text-gray-800 dark:text-gray-200",children:[Z.map(m=>a.jsxs("button",{onClick:()=>{m.key==="about"?C(!0):i(m.key),A(!1)},className:`px-3 py-2 flex items-center gap-2 rounded hover:bg-gray-300 dark:hover:bg-gray-700 ${s===m.key?"bg-gray-300 dark:bg-gray-700 font-medium":""}`,children:[m.icon," ",m.label]},m.key)),!d&&p&&a.jsxs("button",{onClick:()=>{g(),A(!1)},className:"px-3 py-2 flex items-center gap-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:[a.jsx(q,{className:"w-4 h-4"})," ",L.installApp]}),a.jsxs("button",{onClick:()=>{n(),A(!1)},className:"px-3 py-2 flex items-center gap-2 rounded hover:bg-gray-300 dark:hover:bg-gray-700",children:[e==="light"?a.jsx(he,{className:"w-4 h-4"}):a.jsx(me,{className:"w-4 h-4"})," ",e==="light"?L.darkMode:L.lightMode]}),a.jsx("hr",{className:"border-gray-300 dark:border-gray-600 my-2"}),a.jsxs("button",{onClick:()=>{ee(),A(!1)},className:"px-3 py-2 flex items-center gap-2 rounded text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-900/50",children:[a.jsx(fe,{className:"w-4 h-4"})," Clear Cache & Reload"]})]}),a.jsxs("div",{className:"mt-auto text-xs text-gray-500 dark:text-gray-400 border-t border-gray-200 dark:border-gray-700 pt-4",children:["Â© ",new Date().getFullYear()," ",L.project]})]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx("div",{className:`h-full overflow-auto px-4 md:px-6 max-w-7xl xl:max-w-6xl mx-auto w-full ${h==="tabs"?"pb-2 md:pb-6":"pb-20 md:pb-6"}`,children:s==="calendar"?a.jsxs(a.Fragment,{children:[a.jsx(Ae,{activeSystem:T,bsYear:w,bsMonth:$,adYear:N,adMonth:I,onSystemChange:W,onTodayClick:F,theme:e,onThemeToggle:n,todayDetails:D}),a.jsxs("main",{className:"min-h-[60vh] pb-20 md:grid md:grid-cols-12 md:gap-x-6",children:[a.jsxs("aside",{className:"hidden md:block md:col-span-4",children:[a.jsx(je,{todayAd:G,todayBs:E,todayDetails:D,onShowDetailsClick:de}),a.jsx(Te,{date:`${H(E.year)} ${E.monthName} ${H(E.day)}`,dateKey:`${E.year}-${E.month}-${E.day}`,tithi:D?.tithis?.[0]?.name,nakshatra:D?.nakshatras?.[0]?.name,moonRashi:D?.moonRashi})]}),a.jsxs("div",{className:"md:col-span-8 flex flex-col",children:[a.jsx(Ie,{activeSystem:T,currentYear:M,currentMonth:r,onYearChange:m=>T==="bs"?J(m):z(m),onMonthChange:m=>T==="bs"?ae(m):se(m),onPrevMonth:()=>_("prev"),onNextMonth:()=>_("next"),onPrevYear:()=>X("prev"),onNextYear:()=>X("next")}),a.jsx(Ee,{activeSystem:T,currentYear:M,currentMonth:r,onDayClick:b}),a.jsx(Ce,{activeSystem:T,currentYear:M,currentMonth:r})]})]})]}):s==="day-detail"?a.jsx(Re,{onBack:()=>{window.history.pushState({},"","/"),i("calendar")}}):(()=>{const m=Z.find(V=>V.key===s);if(m&&m.page){const V=m.page,O={onBack:()=>i("calendar")};let U={...O};return s==="settings"?U={...O,currentTheme:e,onThemeChange:n,currentMenuStyle:h,onMenuStyleChange:f,currentDesktopLayoutStyle:l,onDesktopLayoutStyleChange:c,onResetSettings:ie,isAndroidApp:ne,onReloadApp:ee}:s==="kundali"?U={...O,setIsKundaliResultsVisible:u,setKundaliBackAction:j}:s==="dharma"?U={...O,setIsDharmaResultsVisible:x,setDharmaBackAction:B}:s==="rashifal"&&(U={...O,date:`${H(E.year)} ${E.monthName} ${H(E.day)}`,dateKey:`${E.year}-${E.month}-${E.day}`,tithi:D?.tithis?.[0]?.name,nakshatra:D?.nakshatras?.[0]?.name}),a.jsx(t.Suspense,{fallback:a.jsx("div",{className:"flex justify-center items-center pb-20 min-h-[60vh]",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}),children:a.jsx(V,{...U})})}return null})()})}),h==="slide"&&a.jsx("div",{className:"fixed bottom-0 left-0 right-0 w-full bg-slate-200 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 z-50 print:hidden md:hidden",children:a.jsx(Me,{})}),h==="tabs"&&a.jsx("div",{className:"md:hidden print:hidden",children:a.jsx(Ne,{activeView:s,onNavigate:m=>{m==="about"?C(!0):i(m)},theme:e,onThemeToggle:n,themeLabel:e==="light"?L.darkMode:L.lightMode})}),a.jsx(De,{date:k,isOpen:R,onClose:()=>y(!1),activeSystem:T}),P&&a.jsx(Pe,{setIsAboutOpen:C}),a.jsx(Le,{})]})};Be.Icon.Default.mergeOptions({iconUrl:Ve,shadowUrl:$e,iconRetinaUrl:Ye});te({onNeedRefresh(){confirm("A new version is available. Reload to update?")&&window.location.reload()},onOfflineReady(){console.log("App ready to work offline")}});pe.createRoot(document.getElementById("root")).render(a.jsx(t.StrictMode,{children:a.jsx(Ke,{})}));
